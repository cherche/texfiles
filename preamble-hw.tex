\usepackage{hyperref}

% equation numbers should be pretty transient
\usepackage{chngcntr}
\counterwithin*{equation}{subsection}

% homework styles for section headings
\renewcommand{\thesubsection}{\arabic{section}(\alph{subsection})}
\renewcommand{\thesection}{\arabic{section}}
\usepackage{titlesec}
\titleformat{\section}
	{\normalfont\Large\bfseries}{Q\thesection}{1em}{}
% subquestions get placed in left margin
\titleformat{\subsection}[leftmargin]
	{\normalfont\bfseries\filleft}{\thesubsection}{0.5em}{}
\titlespacing*{\subsection}{8pc}{1.7pc}{0.5pc}

% fakesection to add question to TOC and bookmarks
% while still not printing it to the actual document
\newcommand{\fakesection}[1]{%
  \par\refstepcounter{section}% Increase section counter
  \sectionmark{#1}% Add section mark (header)
  \addcontentsline{toc}{section}{Q\protect\numberline{\thesection}#1}% Add section to ToC
}

% question command to prettify source
\newcommand{\question}[2]{
  % I insist on using a section counter so that theorem numbers
  % are continued throughout the subquestions of each question.
  % This way theorem numbers are not reused within the same question
  \ifnum\the\value{section}=#1
  \else
    % counter will increase to #1 once \section called
    \setcounter{section}{#1-1}
    \fakesection{}
  \fi
  % https://tex.stackexchange.com/questions/595582/converting-letters-to-numbers-e-g-a-0-b-1-et-cetera
  \setcounter{subsection}{\number\numexpr`#2-`a\relax}
  \subsection{}
}

% need this to properly print the section numbers
% especially since \section and \subsection have no marks (just the numbering)
\usepackage[open, openlevel=2, atend, numbered]{bookmark}
% without the above line, structure still correct but all the entries are blank
% open and openlevel=2 are just nice to have since sections are so short

\makeatletter
% fancy header
\usepackage{fancyhdr}
\pagestyle{fancy}
\setlength{\headheight}{14.5pt}
\addtolength{\topmargin}{-2.5pt}
\fancyhead[L]{\@title}
\fancyhead[C]{\@author}
\fancyhead[R]{\@date}
\fancyfoot[L]{}
\fancyfoot[C]{}
\fancyfoot[R]{\thepage}

% include question and ensure every question gets new page
% this separates the \clearpage functionality from the \section
\newcommand\incq[1]{
  \input{./#1.tex}
  \clearpage
}
